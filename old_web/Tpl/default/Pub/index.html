<style>
.pub_list th{
	text-align:left;
}
</style>
	<div class="manager_right">
		<h3>发布列表 <a href="{&WWW}/Pub/add" style="font-size:12px;font-weight:normal;margin-left:600px;">&gt;&gt;创建发布</a></h3>
		<table class="pub_list" width="800">
			<tr>
				<th>ID</th><th>版本号</th><th width="300">功能描述</th><th>安装包</th><th>有否补丁包</th><th>发布时间</th><th>操作</th>
			</tr>
			<volist name="pubList" id="pub">
			<tr>
				<td>{$pub.id}</td>
				<td>{$pub.ver}</td>
				<td>{$pub.pub_desc}</td>
				<td>
				<neq name="pub.install_file" value="">
				{$pub.install_file}
				<else />
				--
				</neq>
				</td>
				<td>
				<neq name="pub.patch_file" value="">
				是
				<else />
				否
				</neq>
				</td>
				<td>
				<neq name="pub.pub_time" value="">
				{$pub.pub_time}
				<else />
				还未发布
				</neq>
				</td>
				<td>
					<eq name="pub.pub_time" value="">
					<a id="pub_{$pub.id}" href="javascript:doPub({$pub.id});">正式发布</a>
					<a id="dpub_{$pub.id}" href="javascript:delPub({$pub.id});" >删除</a>
					</eq>
					<a href="{&WWW}/Pub/edit?id={$pub.id}">编辑</a>
				</td>
			</tr>
			</volist>
		</table>
	</div>

<script>
function doPub(id){
	if(id>0){
		jQuery.post("{&WWW}/Pub/do_pub",{"id":id},function(data){
			if(data.status){
				$("#pub_"+id).parent("td").prev("td").html(data.data);
				$("#pub_"+id).remove();
			}else{
				alert(data.info);
			}		
		},"json");
	}else{
		alert("参数错误！");
	}
}
function delPub(id){
	if(id>0){
		if(confirm("确定要删除ID："+id+" 的发布吗？")){
		jQuery.post("{&WWW}/Pub/del_pub",{"id":id},function(data){
			if(data.status){
				$("#pub_"+id).parent("td").parent("tr").remove();
			}else{
				alert(data.info);
			}		
		},"json");
		}
	}else{
		alert("参数错误！");
	}
}

</script>